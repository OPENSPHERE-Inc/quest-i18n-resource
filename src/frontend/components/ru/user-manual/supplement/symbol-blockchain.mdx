# Symbol ブロックチェーン

<img src="/Symbol_Logo-wordmark-Dark-BG.svg" className="noborder" />

---

## 1. QUEST における Symbol ブロックチェーンの役割

QUEST は **Symbolブロックチェーン** を基盤とした仮想通貨の決済システムを利用しています。
ブースト（投げ銭）の支払は円やドルなどの法定通貨で支払えず（受け取れず）、
全て Symbol ブロックチェーンのネイティブ通貨である「XYM（ジム）」でやり取りを行います。

つまり、XYM を保有しないユーザーが QUEST を利用する為には、ブーストする側であってもされる側であっても、
仮想通貨を取引できる「取引所」を利用して XYM と法定通貨を交換する必要が発生します。

はっきり言ってしまえば導入の段階で不便ではあるのですが、
一旦 XYM に交換してしまえば、法定通貨であれば金融業者としての資格や登録・審査が必要な決済機能を提供することが可能になります(\*1)。

さて、QUEST におけるブーストは、
サポーターが支払いを行うと直ぐにはパフォーマーに**送金されず**、いわゆる「パフォーマーへ送金予定の資金」としてブロックチェーン上にロックされます。
更に、このロックは期限が決まっており、そのまま放っておくとサポーターに**返金され**ることが決められており、
**一定の条件を満たした場合のみ**パフォーマーに送金されます。

「資金のロック」と「期限切れの返金」「条件を満たしたときの送金」の機能は Symbol ブロックチェーンが提供しており、
一度実行したら、サポーターも、パフォーマーも、QUEST 運営も、それ以外の第三者も、誰も介入することができない自律的なものです (\*2)。

従って、サポーターが行ったブーストの行先は、「パフォーマーに送金されるか」または「サポーターに返金されるか」の二択であり、
QUEST 運営にも、悪意を持ったそれ以外の第三者にも、ブロックチェーン上にロックされた資金を横取りするという事はできません。

まとめると、Symbol ブロックチェーンは、QUEST が実現したい決済機能を、特別な資格や登録・審査の必要が無く、
容易に素早く安全にサービス化できる基盤技術として使用しています。

<div className="is-size-7">

(\*1) つまり、決済にブロックチェーンを使うのは完全にサービス側の都合ですが、こういった資格・登録・審査はかなり ~~めんどくさく~~ 敷居が高く、
    QUEST 運営の様なパっと出の弱小組織にとっては思いついたアイデアが実現できるかどうかの死活問題です。
    尚、「取引所」の運営にも「暗号資産交換業」の登録が必要です。

(\*2) ただし、条件を満たしたかどうかの判定は（Symbol ブロックチェーン外の）QUEST のシステムが行います。

</div>

### Symbol ブロックチェーンを使うメリット（※QUESTの場合）

1. ブーストを受け取る為に銀行口座を用意する必要がない
2. 導入に際して加盟が必要な決済業者がない
3. 運営に特別な資格や登録・審査が必要ない
4. 決済手数料が安価
5. ロック資金の高い安全性
6. 国内の複数の暗号資産取引所で容易に入手可能

### Symbol ブロックチェーンを使うデメリット（※QUESTの場合）

1. 法定通貨で支払えない
2. 法定通貨で受け取れない
3. 暗号資産取引所へのユーザー登録の手間と、交換の手間と、出入金の手間
4. 仮想通貨の価格変動リスク
5. 税金計算の煩雑さ

> 正直、新たなユーザーとしてのデメリットはまだまだ大きいです。
> ただし、ユーザーが既に XYM を保有している場合は、税金計算以外のデメリットは無くなります。

---

## 2. 技術仕様

「送金予約」と「期限切れの返金」は Symbol ブロックチェーンの **シークレットロック**、
「条件を満たしたときの送金」は **シークレットプルーフ** という機能を使っています。

シークレットロックとシークレットプルーフはセットで使用するものです (\*1)。

1. ブーストが作成されると、QUEST が「プルーフ」と呼ばれるランダムな文字列とそれをハッシュ化した「シークレット」のペアを生成します。「プルーフ」は QUEST がサーバーに保管します。
2. サポーターは「シークレット」を受け取り、Symbol ブロックチェーン上で、送金先をパフォーマーとしてシークレットロックを実行します。この時、ブーストに使う額の XYM がロックされます。
   実際は QUEST のサイト上にて「ブースト請求書への支払い」を行うことで、これら一連のトランザクションがまとめて実行されますので、具体的な操作内容は意識していないかもしれません。
3. クエストが承認されると、QUEST は保管しておいた「プルーフ」を Symbol ブロックチェーンに送信します。するとロックされた XYM が解放され、パフォーマーに着金します（授与されます）。
4. クエストが承認されなかった場合は、QUEST は Symbol ブロックチェーンに対しては何もせず、そのままロック期限が過ぎて XYM がサポーターに返金されます。

![Symbol Blockchain 001](/user-manual/ja/supplement/symbol-blockchain-001.svg)

ロックした XYM を第三者が取り出す方法は用意されていないので、資金が横領される心配はありません。
例え QUEST のデータベースから「プルーフ」が漏洩したとしても、送金先はパフォーマーから変更できませんし、返金先もサポーターのままです。

ロックの期限は、クエストの期限＋72時間（Type.C以外、v2の場合。以前はクエスト期限+48時間）
またはクエストの期限+240時間（Type.C、v2の場合。以前はクエスト期限+72時間）に設定されます。
このプラス時間の内訳は、48時間の投票期間と168時間の最終判断猶予（Type.Cの場合）、それに加えて24時間のマージンを持たせてあります。
返金を早期に実行する方法は用意されていないので、早期にクエストが中止された場合でも、返金はこのロック期限まで待つ必要があることに注意してください。
ロック期限は **INVOICE OF BOOST** に記載されています（ロック期間と表記され、ブロック高で表示）

![Symbol Blockchain 002](/user-manual/ja/supplement/symbol-blockchain-002.png)

<div className="is-size-7">

(\*1) 本来は、クロスチェーンでのアトミックスワップに使われる機能ですが、
    仕様として「シークレットプルーフは第三者が実行しても構わない」となっているため、「条件を満たしたときの送金」を QUEST が制御出来ます。

(\*2) ブロック高とはブロックチェーンが始まってから何番目に生成されたブロックかを示す番号で、Symbolブロックチェーンの場合約 30 秒に 1 増える。

</div>
